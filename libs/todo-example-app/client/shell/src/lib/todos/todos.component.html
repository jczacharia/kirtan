<ng-container *ngIf="state$ | async as state">
  <div class="cont">
    <div *ngIf="state.loaded">
      <input type="text" [formControl]="todo" />
      <button [disabled]="todo.invalid" (click)="create()">Add</button>
    </div>
    <div *ngIf="!state.loaded">Loading...</div>
    <div *ngIf="state.loaded && state.todos.length < 1">You have no todos.</div>
    <div class="todo" *ngFor="let todo of state.todos" class="item">
      <pre>{{ todo | json }}</pre>
      <div>
        <b>{{ todo.content }}</b>
        <div>Created: {{ todo.dateCreated | date: 'MMM d, y, h:mm:ss a' }}</div>
        <div>Updated: {{ todo.dateUpdated | date: 'MMM d, y, h:mm:ss a' }}</div>
      </div>
      <div class="tags">
        <div class="tag" *ngFor="let link of todo.todoTags">
          {{ link.tag.name }}
          <span (click)="untag(link.id)">‚ùå</span>
        </div>
      </div>
      <div class="buttons">
        <input type="checkbox" [checked]="todo.done" (change)="toggle(todo)" />
        <div>
          <input
            #inp
            type="text"
            placeholder="Add Tag"
            aria-label="Number"
            matInput
            [matAutocomplete]="auto"
          />
          <button (click)="tag(todo, inp.value)">Add</button>
        </div>
        <button (click)="delete(todo)">Delete</button>
      </div>
    </div>
  </div>

  <mat-autocomplete #auto="matAutocomplete">
    <mat-option *ngFor="let tag of state.tags" [value]="tag">
      {{ tag }}
    </mat-option>
  </mat-autocomplete>
</ng-container>
